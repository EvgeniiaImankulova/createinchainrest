<div class="page-container">
  <div class="page-content">
    <div class="page-header">
      <h1 class="page-title">Настройки корпорации</h1>
      <div class="header-actions">
        <button class="btn btn-primary" (click)="onSave()">
          Сохранить
        </button>
      </div>
    </div>

    <div class="tabs-container">
      <div class="tabs">
        <button
          class="tab"
          [class.active]="activeTab === 'basic'"
          (click)="switchTab('basic')">
          Основная информация
        </button>
        <button
          class="tab"
          [class.active]="activeTab === 'network'"
          (click)="switchTab('network')">
          Общие настройки сети
        </button>
      </div>
    </div>

    <form class="corporation-form">
      <section class="form-section" *ngIf="activeTab === 'basic'">
        <h3 class="subsection-title">Общие сведения</h3>

        <div class="form-group">
          <label class="form-label">Название</label>
          <input
            type="text"
            class="form-input"
            [(ngModel)]="corporationSettings.name"
            name="name"
            placeholder="Введите название корпорации">
        </div>

        <div class="form-group">
          <label class="form-label">Описание</label>
          <textarea
            class="form-input form-textarea"
            [(ngModel)]="corporationSettings.description"
            name="description"
            rows="3"
            placeholder="Введите описание"></textarea>
        </div>

        <div class="form-group">
          <label class="form-label">UID</label>
          <input
            type="text"
            class="form-input"
            [(ngModel)]="corporationSettings.uid"
            name="uid"
            placeholder="123-123-123"
            readonly>
        </div>

        <h3 class="subsection-title">Адрес</h3>

        <div class="form-group">
          <label class="form-label required">Название улицы и дом</label>
          <input
            type="text"
            class="form-input"
            [(ngModel)]="corporationSettings.addressStreet"
            name="addressStreet"
            placeholder="Например: ул. Ленина, д. 10, кв. 5"
            required>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label required">Город/населенный пункт</label>
            <input
              type="text"
              class="form-input"
              [(ngModel)]="corporationSettings.addressCity"
              name="addressCity"
              placeholder="Введите город"
              required>
          </div>

          <div class="form-group">
            <label class="form-label required">Область/регион</label>
            <input
              type="text"
              class="form-input"
              [(ngModel)]="corporationSettings.addressRegion"
              name="addressRegion"
              placeholder="Введите регион"
              required>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label required">Страна</label>
            <input
              type="text"
              class="form-input"
              [(ngModel)]="corporationSettings.addressCountry"
              name="addressCountry"
              placeholder="Введите страну"
              required>
          </div>

          <div class="form-group">
            <label class="form-label">Почтовый код</label>
            <input
              type="text"
              class="form-input"
              [(ngModel)]="corporationSettings.addressPostalCode"
              name="addressPostalCode"
              placeholder="Введите почтовый код">
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Комментарии к адресу</label>
          <textarea
            class="form-input form-textarea"
            [(ngModel)]="corporationSettings.addressComment"
            name="addressComment"
            rows="2"
            placeholder="Дополнительная информация об адресе"></textarea>
        </div>

        <div class="map-link-wrapper">
          <svg class="map-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
            <path d="M10 10C10.5304 10 11.0391 9.78929 11.4142 9.41421C11.7893 9.03914 12 8.53043 12 8C12 7.46957 11.7893 6.96086 11.4142 6.58579C11.0391 6.21071 10.5304 6 10 6C9.46957 6 8.96086 6.21071 8.58579 6.58579C8.21071 6.96086 8 7.46957 8 8C8 8.53043 8.21071 9.03914 8.58579 9.41421C8.96086 9.78929 9.46957 10 10 10Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M16 8C16 13 10 17 10 17C10 17 4 13 4 8C4 6.4087 4.63214 4.88258 5.75736 3.75736C6.88258 2.63214 8.4087 2 10 2C11.5913 2 13.1174 2.63214 14.2426 3.75736C15.3679 4.88258 16 6.4087 16 8Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <a href="#" class="map-link" (click)="$event.preventDefault()">Показать на карте</a>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Широта*</label>
            <input
              type="number"
              class="form-input"
              [(ngModel)]="corporationSettings.addressLatitude"
              name="addressLatitude"
              placeholder="55.751244"
              step="0.000001">
          </div>

          <div class="form-group">
            <label class="form-label">Долгота*</label>
            <input
              type="number"
              class="form-input"
              [(ngModel)]="corporationSettings.addressLongitude"
              name="addressLongitude"
              placeholder="37.618423"
              step="0.000001">
          </div>
        </div>

        <h3 class="subsection-title">Реквизиты</h3>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">ИНН</label>
            <input
              type="text"
              class="form-input"
              [(ngModel)]="corporationSettings.inn"
              name="inn"
              placeholder="Введите ИНН">
          </div>

          <div class="form-group">
            <label class="form-label">КПП</label>
            <input
              type="text"
              class="form-input"
              [(ngModel)]="corporationSettings.kpp"
              name="kpp"
              placeholder="Введите КПП">
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">ОГРН</label>
          <input
            type="text"
            class="form-input"
            [(ngModel)]="corporationSettings.ogrn"
            name="ogrn"
            placeholder="Введите ОГРН">
        </div>

        <h3 class="subsection-title">Контактная информация</h3>

        <div class="form-group">
          <app-searchable-select
            [label]="'Руководитель'"
            [options]="directorOptions"
            [placeholder]="'Поиск...'"
            [(ngModel)]="corporationSettings.director_id"
            (ngModelChange)="onDirectorSelect($event)"
            name="director">
          </app-searchable-select>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Телефон</label>
            <input
              type="tel"
              class="form-input"
              [(ngModel)]="corporationSettings.phone"
              name="phone"
              placeholder="+7 (___) ___-__-__">
          </div>

          <div class="form-group">
            <label class="form-label">E-mail</label>
            <input
              type="email"
              class="form-input"
              [(ngModel)]="corporationSettings.email"
              name="email"
              placeholder="example@domain.com">
          </div>
        </div>
      </section>

      <section class="form-section" *ngIf="activeTab === 'network'">
        <div class="form-group">
          <app-searchable-select
            [label]="'Валюта'"
            [options]="currencies"
            [placeholder]="'Поиск валюты...'"
            [(ngModel)]="corporationSettings.currency"
            name="currency">
          </app-searchable-select>
        </div>

        <div class="form-group">
          <label class="checkbox-container">
            <input
              type="checkbox"
              class="checkbox-input"
              [(ngModel)]="corporationSettings.isFranchiseNetwork"
              name="isFranchiseNetwork">
            <span class="checkbox-label">
              Сеть франшизная?
            </span>
          </label>
        </div>

        <div class="form-group" *ngIf="corporationSettings.isFranchiseNetwork">
          <label class="form-label">Настройки роялти по умолчанию, %</label>
          <input
            type="number"
            class="form-input"
            [(ngModel)]="corporationSettings.defaultRoyalty"
            name="defaultRoyalty"
            placeholder="0"
            min="0"
            max="100"
            step="0.01">
        </div>
      </section>
    </form>
  </div>
</div>

<app-employee-sidebar
  [(isOpen)]="isEmployeeSidebarOpen"
  (employeeCreated)="onEmployeeCreated($event)">
</app-employee-sidebar>
